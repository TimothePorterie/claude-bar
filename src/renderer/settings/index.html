<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Claude Bar Settings</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="settings-container">
      <!-- Title bar drag region -->
      <div class="title-bar">
        <h1>Settings</h1>
      </div>

      <!-- Connection status -->
      <div class="section">
        <h2>Connection</h2>
        <div class="setting-row" style="margin-bottom: 12px;">
          <label for="authMode">Authentication method</label>
          <select id="authMode">
            <option value="app">Claude Bar (OAuth)</option>
            <option value="cli">CLI (Keychain)</option>
          </select>
        </div>
        <!-- Connected state -->
        <div class="connection-status" id="connectionStatus">
          <div class="status-indicator connected" id="statusIndicator"></div>
          <div class="status-info">
            <span class="status-text" id="statusText">Connected</span>
            <span class="status-detail">
              <span class="status-email" id="statusEmail">--</span>
              <span class="auth-source-badge" id="authSourceBadge" style="display: none;">via CLI</span>
            </span>
          </div>
          <button class="logout-btn" id="logoutBtn" style="display: none;">Log Out</button>
        </div>
        <!-- Not connected state -->
        <div class="not-connected-help" id="notConnectedHelp" style="display: none;">
          <button class="login-btn" id="loginBtn">Log In with Claude</button>
          <p class="hint" style="margin-top: 8px;">Or authenticate via CLI: <code class="inline-code">claude login</code></p>
        </div>
        <!-- Waiting for code state -->
        <div class="auth-code-section" id="authCodeSection" style="display: none;">
          <p class="auth-code-hint">Authenticate in your browser, then paste the code below:</p>
          <div class="auth-code-input-row">
            <input type="text" id="authCodeInput" class="auth-code-input" placeholder="Paste authorization code here" spellcheck="false" autocomplete="off" />
            <button class="validate-btn" id="validateBtn">Validate</button>
          </div>
          <div class="auth-code-actions">
            <button class="cancel-btn" id="cancelLoginBtn">Cancel</button>
            <span class="auth-error" id="authError" style="display: none;"></span>
          </div>
        </div>
      </div>

      <!-- Refresh interval -->
      <div class="section">
        <h2>Refresh Interval</h2>
        <div class="setting-row">
          <label for="refreshInterval">Update quota every</label>
          <select id="refreshInterval">
            <option value="30">30 seconds</option>
            <option value="60" selected>1 minute</option>
            <option value="120">2 minutes</option>
            <option value="300">5 minutes</option>
            <option value="600">10 minutes</option>
          </select>
        </div>
        <div class="setting-row">
          <label for="adaptiveRefresh">
            <input type="checkbox" id="adaptiveRefresh" checked />
            Adaptive refresh
          </label>
        </div>
        <p class="setting-description">When enabled, refresh faster at warning (2x) and critical (4x) levels to keep you informed.</p>
      </div>

      <!-- Notifications -->
      <div class="section">
        <h2>Notifications</h2>
        <div class="setting-row">
          <label for="notificationsEnabled">
            <input type="checkbox" id="notificationsEnabled" checked />
            Enable quota notifications
          </label>
        </div>
        <p class="setting-description">Get notified when your quota reaches warning or critical levels, and when it resets.</p>
      </div>

      <!-- Thresholds -->
      <div class="section">
        <h2>Alert Thresholds</h2>
        <div class="threshold-setting">
          <div class="threshold-header">
            <label for="warningThreshold">Warning level</label>
            <span class="threshold-value" id="warningValue">70%</span>
          </div>
          <input type="range" id="warningThreshold" min="50" max="89" value="70" class="threshold-slider warning" />
        </div>
        <div class="threshold-setting">
          <div class="threshold-header">
            <label for="criticalThreshold">Critical level</label>
            <span class="threshold-value" id="criticalValue">90%</span>
          </div>
          <input type="range" id="criticalThreshold" min="60" max="99" value="90" class="threshold-slider critical" />
        </div>
        <p class="setting-description">Set when you want to be notified about quota usage. Warning must be less than critical.</p>
        <div class="setting-row" style="margin-top: 12px;">
          <label for="showTimeToCritical">
            <input type="checkbox" id="showTimeToCritical" checked />
            Show "Est. critical" prediction
          </label>
        </div>
      </div>

      <!-- Startup -->
      <div class="section">
        <h2>Startup</h2>
        <div class="setting-row">
          <label for="launchAtLogin">
            <input type="checkbox" id="launchAtLogin" />
            Launch Claude Bar at login
          </label>
        </div>
      </div>

      <!-- Updates -->
      <div class="section">
        <h2>Updates</h2>
        <div class="update-status" id="updateStatus">
          <span class="update-text" id="updateText">Checking for updates...</span>
          <div class="update-progress" id="updateProgress" style="display: none;">
            <div class="update-progress-bar" id="updateProgressBar"></div>
          </div>
          <div class="update-actions">
            <button class="check-btn" id="checkBtn">Check for Updates</button>
            <button class="update-btn" id="updateBtn" style="display: none;">Install Update</button>
          </div>
        </div>
      </div>

      <!-- About -->
      <div class="section about">
        <p class="version">Claude Bar v<span id="appVersion">1.0.0</span></p>
        <p class="credits">Monitor your Claude Code quotas from the menu bar</p>
      </div>
    </div>
    <script type="module" src="./renderer.ts"></script>
  </body>
</html>
